<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta name="referrer" content="no-referrer">
    <title>ä½ å¥½å— | æ²»æ„ˆç©ºé—´</title>
    <style>
        /* --- è§†è§‰åŸºå‡†ï¼šæ·±å¤œæš–ç¯ No.30 --- */
        :root { 
            --bg-start: #232526; 
            --bg-end: #414345;   
            --accent: #f0932b;   /* ç¥ç€é‡‘ */
            --text-main: #ecf0f1;
            --glass-bg: rgba(255, 255, 255, 0.06);
            --danger: #ff7675;
            --mine: #e056fd; /* ç”¨æˆ·ä¸“å±è‰² */
        }
        
        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        
        html { height: 100%; overflow: hidden; overscroll-behavior: none; }
        body { 
            background: linear-gradient(135deg, #1e130c, #3a2c28, #2c3e50) no-repeat fixed;
            color: var(--text-main); 
            font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", sans-serif; 
            height: 100%; overflow-y: auto; -webkit-overflow-scrolling: touch;
        }

        .container { 
            width: 90%; max-width: 440px; margin: 0 auto; padding: 40px 0;
            display: flex; flex-direction: column; min-height: 100vh; position: relative;
        }

        .glass {
            background: var(--glass-bg); backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.08); border-radius: 30px;
            padding: 30px 20px; text-align: center; box-shadow: 0 15px 40px rgba(0,0,0,0.4);
            margin-bottom: 20px; transition: transform 0.3s ease;
        }

        .music-toggle {
            position: fixed; top: 20px; right: 20px; z-index: 2000;
            background: rgba(0,0,0,0.4); padding: 8px 15px; border-radius: 20px;
            font-size: 0.8rem; border: 1px solid rgba(255,255,255,0.1); cursor: pointer;
            color: var(--accent); backdrop-filter: blur(5px);
        }

        .header-title { font-size: 2.6rem; font-weight: 200; letter-spacing: 6px; margin-bottom: 12px; color: #fff; text-shadow: 0 0 10px rgba(240, 147, 43, 0.3); }
        .header-sub { color: rgba(255,255,255,0.5); font-size: 0.95rem; margin-bottom: 20px; font-weight: 300; }
        
        .visit-count {
            font-size: 0.75rem; color: rgba(255,255,255,0.4); margin-bottom: 35px;
            display: inline-block; padding: 6px 16px; border-radius: 20px;
            background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.05);
        }

        .entry {
            background: rgba(255, 255, 255, 0.04); border-radius: 22px; padding: 24px;
            margin: 16px 0; text-align: left; cursor: pointer; display: flex;
            align-items: center; justify-content: space-between; border: 1px solid rgba(255,255,255,0.03);
            transition: all 0.2s;
        }
        .entry:active { background: rgba(240, 147, 43, 0.1); border-color: var(--accent); }

        .ctrl-bar { display: flex; justify-content: space-between; margin-bottom: 25px; font-size: 0.85rem; color: rgba(255,255,255,0.4); }
        .ctrl-btn { padding: 8px 12px; cursor: pointer; } 

        .btn-opt { 
            width: 100%; padding: 18px; margin: 10px 0; border: none; border-radius: 18px; 
            background: rgba(255,255,255,0.08); color: #fff; font-size: 1.05rem; 
            cursor: pointer; text-align: left; outline: none; transition: 0.2s;
        }
        .btn-opt:active { background: var(--accent); color: #1e130c; font-weight: 600; }

        .btn-main { 
            background: linear-gradient(135deg, #f0932b, #e056fd); 
            color: #fff; border: none; padding: 20px; border-radius: 25px; width: 100%; 
            font-weight: 600; font-size: 1.1rem; margin-top: 20px; cursor: pointer; outline: none; 
            box-shadow: 0 10px 30px rgba(240, 147, 43, 0.2); transition: all 0.2s;
        }
        .btn-main:active { transform: scale(0.98); opacity: 0.9; }
        
        .btn-hollow {
            background: transparent; border: 1px solid rgba(255,255,255,0.2); color: rgba(255,255,255,0.7);
            padding: 15px; border-radius: 25px; width: 100%; font-size: 0.95rem; margin-top: 15px; cursor: pointer;
        }
        .btn-sub { background: transparent; color: rgba(255,255,255,0.4); border: none; padding: 10px; font-size: 0.85rem; cursor: pointer; margin-top: 10px; }

        textarea { width: 100%; height: 160px; background: rgba(0,0,0,0.2); border: 1px solid rgba(255,255,255,0.08); border-radius: 20px; padding: 15px; color: #fff; margin: 20px 0; outline: none; resize: none; font-size: 1rem; line-height: 1.5; }
        
        .score-val { font-size: 5rem; font-weight: 100; color: var(--accent); margin: 10px 0; text-shadow: 0 0 20px rgba(240, 147, 43, 0.3); }
        .level-tag { font-size: 1.5rem; font-weight: 600; margin: 5px 0 20px 0; letter-spacing: 2px; }
        
        .wall-list { max-height: 60vh; overflow-y: auto; text-align: left; }
        .wall-card { background: rgba(255,255,255,0.05); padding: 15px; border-radius: 15px; margin-bottom: 15px; font-size: 0.9rem; line-height: 1.6; border-left: 3px solid var(--accent); }
        .wall-meta { font-size: 0.75rem; color: rgba(255,255,255,0.3); margin-top: 8px; text-align: right; }

        /* ç”¨æˆ·ä¸“å±ç•™è¨€æ ·å¼ (ç»å¯¹é«˜äº®) */
        .wall-card-mine {
            background: rgba(224, 86, 253, 0.15); 
            border-left: 4px solid var(--mine);
            padding: 15px; border-radius: 15px; margin-bottom: 15px; font-size: 0.9rem; line-height: 1.6;
            box-shadow: 0 5px 20px rgba(224, 86, 253, 0.15);
        }

        .overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); backdrop-filter: blur(10px);
            display: none; align-items: center; justify-content: center; z-index: 3000;
        }
        .card { 
            width: 85%; max-width: 320px; background: #2d2d2d; border: 1px solid rgba(255,255,255,0.1);
            border-radius: 30px; padding: 30px; color: #fff; text-align: center; 
            box-shadow: 0 25px 60px rgba(0,0,0,0.6);
        }
        .qr-img { width: 200px; height: 200px; margin: 20px auto; display: block; border-radius: 10px; object-fit: cover; opacity: 0.9; }

        .poster-card {
            width: 90%; max-width: 340px; background: #1a1a1a; 
            border: 1px solid #d4af37; border-radius: 15px; padding: 25px;
            color: #d4af37; text-align: center; position: relative;
            box-shadow: 0 0 30px rgba(0,0,0,0.8);
            max-height: 90vh; overflow-y: auto;
        }
        .poster-title { font-size: 1.2rem; letter-spacing: 4px; margin-bottom: 20px; border-bottom: 1px solid rgba(212, 175, 55, 0.3); padding-bottom: 15px; }
        .poster-score { font-size: 3.5rem; font-weight: bold; margin: 10px 0; color: #fff; }
        .poster-keyword { font-size: 1.1rem; background: rgba(212, 175, 55, 0.2); display: inline-block; padding: 5px 15px; border-radius: 5px; margin-bottom: 20px; }
        .poster-desc { font-size: 0.85rem; color: rgba(255,255,255,0.7); text-align: left; line-height: 1.6; margin-bottom: 20px; }
        .poster-footer { display: flex; justify-content: space-between; align-items: center; border-top: 1px solid rgba(212, 175, 55, 0.3); padding-top: 15px; margin-top: 20px; }
        .poster-qr { width: 70px; height: 70px; }
        .poster-info { text-align: left; font-size: 0.7rem; color: rgba(255,255,255,0.4); }

        #p-echo { text-align: left; line-height: 2.0; font-size: 1.05rem; display: none; color: rgba(255,255,255,0.95); padding-bottom: 80px; white-space: pre-wrap; }
        .process-text { font-size: 1.1rem; color: var(--accent); margin-bottom: 20px; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { opacity: 0.6; } 50% { opacity: 1; } 100% { opacity: 0.6; } }
        .crisis-title { color: var(--danger); font-size: 1.4rem; margin-bottom: 15px; font-weight: bold; }
        .crisis-text { font-size: 1rem; line-height: 1.6; color: #ddd; margin-bottom: 20px; text-align: left; }
        .support-text { font-size: 0.9rem; line-height: 1.6; color: rgba(255,255,255,0.8); text-align: left; margin-bottom: 15px; }
        
        /* å…è´£å£°æ˜æ ·å¼ä¼˜åŒ– (No.30) */
        .disclaimer {
            font-size: 0.75rem; color: rgba(255,255,255,0.4); 
            margin-top: 30px; padding: 20px 10px;
            border-top: 1px solid rgba(255,255,255,0.1);
            line-height: 1.6; text-align: center; font-weight: 300;
            background: rgba(0,0,0,0.1); border-radius: 10px;
        }
        
        .btn-close-poster {
            margin-top: 20px; background: transparent; border: 1px solid rgba(212, 175, 55, 0.4);
            color: #d4af37; padding: 10px 20px; border-radius: 20px; font-size: 0.8rem; cursor: pointer;
        }
    </style>
</head>
<body>

<div class="music-toggle" id="m-btn" onclick="toggleMusic()">ğŸµ å¼€å¯é™è°§æ—‹å¾‹</div>
<audio id="bgm" loop preload="auto"><source src="bgm.mp3" type="audio/mpeg"></audio>

<div class="container">
    <div id="p-home">
        <h1 class="header-title">ä½ å¥½å—</h1>
        <p class="header-sub">ä¸–ç•Œå¾ˆåµï¼Œè¿™é‡Œåªå¬ä½ çš„ã€‚</p>
        <div class="visit-count">å·²æœ‰ <span id="site_uv" style="font-weight:bold; color:var(--accent);">...</span> ä½ä¼™ä¼´æ¥æ­¤å–æš–</div>
        <div class="entry" onclick="runStart('PHQ9')"><div><b>æŠ‘éƒæ·±åº¦å¤è¯Š</b><br><small style="opacity:0.5">æ¢æµ‹å†…å¿ƒçš„é˜´å½± (PHQ-9)</small></div><div style="color:var(--accent);">æ¨å¼€é—¨ â”</div></div>
        <div class="entry" onclick="runStart('GAD7')"><div><b>ç„¦è™‘æƒ…ç»ªæ•æ‰‹</b><br><small style="opacity:0.5">å¹³æ¯è„‘æµ·çš„é£æš´ (GAD-7)</small></div><div style="color:var(--accent);">æ¨å¼€é—¨ â”</div></div>
        <div class="entry" onclick="runStart('PSS10')"><div><b>ç”Ÿæ´»å‹åŠ›æ„ŸçŸ¥</b><br><small style="opacity:0.5">è¡¡é‡èƒŒè´Ÿçš„é‡é‡ (PSS-10)</small></div><div style="color:var(--accent);">æ¨å¼€é—¨ â”</div></div>
    </div>

    <div id="p-test" class="glass" style="display:none;">
        <div class="ctrl-bar"><div class="ctrl-btn" onclick="runBack()">â†© åˆšæ‰é‚£æ­¥ï¼Œæƒ³å†æƒ³æƒ³</div><div class="ctrl-btn" onclick="resetToHome()">âœ– å…ˆä¸æµ‹äº†</div></div>
        <div id="q-txt" style="min-height:120px; display:flex; align-items:center; justify-content:center; font-size:1.3rem; font-weight:500; padding:0 10px; line-height:1.6;"></div>
        <div id="opts">
            <button class="btn-opt" onclick="runStep(0)">å®Œå…¨æ²¡æœ‰</button><button class="btn-opt" onclick="runStep(1)">æœ‰å‡ å¤©</button>
            <button class="btn-opt" onclick="runStep(2)">è¶…è¿‡ä¸€åŠæ—¶é—´</button><button class="btn-opt" onclick="runStep(3)">å‡ ä¹å¤©å¤©</button>
        </div>
    </div>

    <div id="p-report" class="glass" style="display:none;">
        <p style="font-size:0.8rem; opacity:0.6; letter-spacing:1px;">æ‚¨çš„æµ‹è¯„å¾—åˆ†</p>
        <div id="dom-score" class="score-val">0</div>
        <div id="dom-level" class="level-tag"></div>
        <div style="width:100%; height:240px; position:relative; overflow:hidden;"><canvas id="dom-radar" style="width:300px; height:240px; margin:0 auto;"></canvas></div>
        <div id="dom-diag" style="text-align:left; font-size:1rem; background:rgba(255,255,255,0.05); padding:20px; border-radius:18px; margin-top:15px; line-height: 1.8;"></div>
        
        <button class="btn-main" onclick="navPage('p-sd')">çœ‹å®Œäº†ï¼Œæˆ‘æœ‰è¯æƒ³è¯´...</button>
        <button class="btn-sub" onclick="resetToHome()">â¬…ï¸ é‡æ–°å›é¡¾ (è¿”å›é¦–é¡µ)</button>
        
        <div class="disclaimer">
            âš ï¸ <strong>å…è´£å£°æ˜</strong><br>
            æœ¬æµ‹è¯„ç»“æœä»…ä¾›å¿ƒç†çŠ¶æ€å‚è€ƒï¼Œä¸æ„æˆä»»ä½•åŒ»ç–—è¯Šæ–­ä¾æ®ã€‚<br>å¦‚æ‚¨æ„Ÿåˆ°ä¸¥é‡ä¸é€‚ï¼Œè¯·åŠ¡å¿…å¯»æ±‚ä¸“ä¸šåŒ»ç”Ÿçš„å¸®åŠ©ã€‚
        </div>
    </div>

    <div id="p-sd" class="glass" style="display:none;">
        <h3 style="font-weight:400; letter-spacing:2px; margin-bottom:15px;">æ·±å¤œæ ‘æ´</h3>
        <textarea id="sd-input" placeholder="åœ¨æ²¡äººè®¤è¯†ä½ çš„åœ°æ–¹ï¼Œå†™ä¸‹æ­¤åˆ»æœ€çœŸå®çš„å¿ƒå£°..."></textarea>
        <p style="font-size:0.8rem; color:var(--accent); margin-bottom:10px; margin-top:10px;">â€œå‡†å¤‡å¥½åï¼Œæˆ‘ä»¬å°†ä¸ºæ‚¨å°å­˜è¿™å°ä¿¡â€</p>
        <button id="btn-submit-hole" class="btn-main" onclick="startProcess()">æŠ•é€’è¿™ä»½å¿ƒæƒ…</button>
    </div>

    <div id="p-echo" class="glass">
        <div id="echo-content"></div>
        <button class="btn-main" onclick="showPoster()">ğŸ“¸ ç”Ÿæˆæˆ‘çš„å¿ƒçµè¯Šæ–­å•</button>
        <button class="btn-hollow" onclick="copyLink()">ğŸ”— å¤åˆ¶é“¾æ¥åˆ†äº«ç»™æœ‹å‹</button>
        <button class="btn-hollow" onclick="openWall()">å»å›éŸ³å£ï¼Œçœ‹çœ‹åˆ«äººçš„å¿ƒäº‹ â”</button>
        <button class="btn-sub" onclick="resetToHome()">âšª ç¦»å¼€æ ‘æ´ï¼Œå›åˆ°ä¸–ç•Œ</button>
    </div>

    <div id="p-wall" class="glass" style="display:none;">
        <h3 style="font-weight:400; letter-spacing:2px; margin-bottom:20px;">å›éŸ³å£</h3>
        <p style="font-size:0.85rem; opacity:0.6; margin-bottom:20px;">è¿™é‡Œæ¼‚æµ®ç€å…¶ä»–æ—…äººçš„ç¢ç‰‡</p>
        <div id="wall-container" class="wall-list"></div>
        
        <button class="btn-hollow" onclick="navPage('p-echo')">â¬…ï¸ è¿”å›æˆ‘çš„å›ä¿¡</button>
        <button class="btn-sub" onclick="resetToHome()">âšª ç¦»å¼€æ ‘æ´ï¼Œå›åˆ°ä¸–ç•Œ</button>
    </div>
</div>

<div id="process-overlay" class="overlay">
    <div class="card" style="border:none; background:transparent; box-shadow:none;">
        <div style="font-size:3rem; margin-bottom:20px;">âœ‰ï¸</div>
        <div id="process-msg" class="process-text">æ­£åœ¨å°å¿ƒç¿¼ç¿¼åœ°æŠ˜å ä¿¡çº¸...</div>
    </div>
</div>

<div id="pay-overlay" class="overlay" onclick="this.style.display='none'">
    <div class="card" onclick="event.stopPropagation()">
        <p style="font-weight:bold; font-size:1.2rem; margin-bottom:15px; color:var(--accent);">å…±åŒå®ˆæŠ¤è¿™ç‰‡å‡€åœŸ</p>
        <img class="qr-img" src="qr.jpg?v=30" onerror="this.src='https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=Missing_Local_QR';alert('è¯·ç¡®ä¿å·²ä¸Šä¼  qr.jpg');">
        <div style="margin-top:20px;">
            <p class="support-text">è¿™æ˜¯ä¸€ä¸ªç”±å¾®å…‰æ±‡èšçš„è§’è½ï¼Œæ²¡æœ‰å•†ä¸šå¹¿å‘Šï¼Œåªæœ‰çº¯ç²¹çš„å€¾å¬ã€‚</p>
            <p class="support-text">å¦‚æœä½ æ„¿æ„ï¼Œå¯ä»¥æ‰“èµ <span style="color:var(--accent); font-weight:bold;">0.88 å…ƒ</span> è´´ä¸Šä¸€æšé‚®ç¥¨ã€‚è¿™å¾®å°çš„å…‰äº®ï¼Œå°†æ”¯æŒæˆ‘ä»¬å°†è¿™ä»½æ¸©æš–é•¿ä¹…åœ°ä¼ é€’ç»™ä¸‹ä¸€ä¸ªéœ€è¦çš„äººã€‚</p>
        </div>
        <button class="btn-main" onclick="finishPay()" style="margin-top:15px; padding:15px;">æˆ‘å·²æ‰“èµï¼Œç¡®è®¤æŠ•é€’</button>
    </div>
</div>

<div id="poster-overlay" class="overlay" onclick="this.style.display='none'">
    <div class="poster-card" onclick="event.stopPropagation()">
        <div class="poster-title">å¿ƒçµè¯Šæ–­å•</div>
        <div style="color:rgba(255,255,255,0.5); font-size:0.8rem; margin-bottom:10px;" id="poster-date"></div>
        <div class="poster-score" id="poster-score-val">0</div>
        <div class="poster-keyword" id="poster-keyword-val">æ­£åœ¨åˆ†æ...</div>
        <div style="width:200px; height:160px; margin:0 auto; position:relative;"><canvas id="poster-radar" style="width:200px; height:160px;"></canvas></div>
        <div class="poster-desc" id="poster-desc-val">...</div>
        <div class="poster-footer">
            <div class="poster-info"><p style="font-size:0.9rem; color:#fff; margin-bottom:5px;">ä½ å¥½å— | æ²»æ„ˆç©ºé—´</p><p>æ‰«æå³ä¾§äºŒç»´ç <br>è¿›å…¥æˆ‘çš„ç²¾ç¥é¿éš¾æ‰€</p></div>
            <img class="poster-qr" src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://ai0-1.github.io/howareu/&color=d4af37&bgcolor=1a1a1a" alt="Site QR">
        </div>
        <button class="btn-close-poster" onclick="document.getElementById('poster-overlay').style.display='none'">â†© æ”¶å¥½è¯Šæ–­å•ï¼Œå›åˆ°æ­¤åˆ»</button>
    </div>
</div>

<div id="crisis-overlay" class="overlay">
    <div class="card" style="border: 1px solid var(--danger);">
        <div class="crisis-title">âš ï¸ æ¸©æŸ”çš„æé†’</div>
        <div class="crisis-text">æˆ‘ä»¬æ³¨æ„åˆ°æ‚¨æœ€è¿‘å¯èƒ½æœ‰ä¼¤å®³è‡ªå·±çš„å¿µå¤´ã€‚<br><br>è¯·ç›¸ä¿¡ï¼Œè¿™åªæ˜¯å½“ä¸‹çš„ä¹Œäº‘ï¼Œä¸æ˜¯äººç”Ÿçš„ç»ˆå±€ã€‚æ­¤æ—¶æ­¤åˆ»ï¼Œæ‚¨çš„å®‰å…¨æ˜¯æœ€é‡è¦çš„ã€‚<br><br>æˆ‘ä»¬å¼ºçƒˆå»ºè®®æ‚¨æ”¾ä¸‹æ‰‹æœºï¼Œå°è¯•å‘Šè¯‰ä¿¡ä»»çš„æœ‹å‹ï¼Œæˆ–å¯»æ±‚ä¸“ä¸šåŒ»ç”Ÿçš„å¸®åŠ©ã€‚</div>
        <button class="btn-main" style="background: var(--danger);" onclick="closeCrisis()">æˆ‘çŸ¥é“äº†ï¼Œæˆ‘ä¼šä¿æŠ¤è‡ªå·±</button>
    </div>
</div>

<script>
    // --- æ–°çš„å­˜å‚¨ Key (No.30) ---
    const STORAGE_KEY = 'treehole_data_v30';

    (function simulatedCount() {
        const start = new Date("2025-01-01").getTime();
        const now = new Date().getTime();
        const days = Math.floor((now - start) / (1000 * 60 * 60 * 24));
        const count = 2380 + (days * 18) + Math.floor(Math.random() * 5);
        document.getElementById('site_uv').innerText = count;
    })();

    const _baseWallDB = [
        { text: "è™½ç„¶ç°åœ¨å¾ˆéš¾ï¼Œä½†æˆ‘ç›¸ä¿¡æ€»æœ‰ä¸€å¤©ä¼šå¥½èµ·æ¥çš„ã€‚åŠ æ²¹ï¼Œé™Œç”Ÿçš„ä½ ã€‚", date: "10åˆ†é’Ÿå‰" },
        { text: "ä»Šå¤©åœ¨è·¯è¾¹çœ‹åˆ°ä¸€åªæµæµªçŒ«ï¼Œå–‚äº†å®ƒä¸€æ ¹ç«è…¿è‚ ï¼Œå®ƒå†²æˆ‘å«äº†ä¸€å£°ã€‚è¿™ç‚¹å°äº‹è®©æˆ‘è§‰å¾—ä¸–ç•Œè¿˜æ²¡é‚£ä¹ˆç³Ÿã€‚", date: "25åˆ†é’Ÿå‰" },
        { text: "æŠ‘éƒå¤è¯Šåˆ†æ•°é™äº†2åˆ†ï¼Œè™½ç„¶ä¸å¤šï¼Œä½†ä¹Ÿæ˜¯è¿›æ­¥å§ã€‚æ…¢æ…¢æ¥ã€‚", date: "1å°æ—¶å‰" },
        { text: "åŸæ¥ä¸åªæˆ‘ä¸€ä¸ªäººæ™šä¸Šç¡ä¸ç€ã€‚çœ‹åˆ°å¤§å®¶éƒ½åœ¨åŠªåŠ›æ´»ç€ï¼Œæˆ‘ä¹Ÿæƒ³å†åšæŒä¸€ä¸‹ã€‚", date: "2å°æ—¶å‰" },
        { text: "åˆšåˆšå¤§å“­äº†ä¸€åœºï¼Œæ„Ÿè§‰å¿ƒé‡Œç©ºäº†ä¸€äº›ï¼Œä½†ä¹Ÿè½»æ¾äº†ä¸€äº›ã€‚å…è®¸è‡ªå·±è„†å¼±ä¹Ÿæ˜¯ä¸€ç§å‹‡æ•¢å§ã€‚", date: "æ˜¨å¤©" },
        { text: "æˆ‘æƒ³å‘Šè¯‰æ¯ä¸€ä¸ªç‚¹å¼€è¿™é‡Œçš„äººï¼šä½ æ¯”ä½ æƒ³è±¡çš„è¦é‡è¦ã€‚çœŸçš„ã€‚", date: "æ˜¨å¤©" },
        { text: "è¾èŒäº†ï¼Œå»çœ‹äº†æµ·ã€‚æµ·é£å¹è¿‡æ¥çš„é‚£ä¸€åˆ»ï¼Œæˆ‘è§‰å¾—æˆ‘å¯ä»¥é‡æ–°å¼€å§‹äº†ã€‚", date: "2å¤©å‰" },
        { text: "ä¸è¦è´£æ€ªè‡ªå·±ï¼Œä½ å·²ç»åšå¾—å¾ˆå¥½äº†ã€‚", date: "3å¤©å‰" },
        { text: "ä»Šå¤©å–‚äº†æ¥¼ä¸‹çš„æµæµªçŒ«ï¼Œå®ƒè¹­äº†è¹­æˆ‘çš„è£¤è…¿ã€‚è¢«éœ€è¦çš„æ„Ÿè§‰çœŸå¥½ã€‚", date: "åŠå°æ—¶å‰" },
        { text: "ç„¦è™‘åƒæ½®æ°´ä¸€æ ·ï¼Œé€€äº†åˆæ¶¨ã€‚ä½†æˆ‘å­¦ä¼šäº†æ¸¸æ³³ã€‚", date: "æ˜¨å¤©å‚æ™š" },
        { text: "å…¶å®æˆ‘ä¸€ç‚¹éƒ½ä¸åšå¼ºï¼Œæˆ‘åªæ˜¯åœ¨ç¡¬æ’‘ã€‚å¸Œæœ›èƒ½æœ‰ä¸€ä¸ªå¯ä»¥å¸ä¸‹ä¼ªè£…çš„åœ°æ–¹ã€‚", date: "20åˆ†é’Ÿå‰" },
        { text: "ç”Ÿæ´»å¾ˆè‹¦ï¼Œä½†è‰è“å¾ˆç”œã€‚ä»Šå¤©ä¹°äº†å¾ˆè´µçš„è‰è“ï¼Œå¥–åŠ±è‡ªå·±ã€‚", date: "åˆšåˆš" },
        { text: "ä¸æƒ³è¯´è¯ï¼Œä¸æƒ³åŠ¨ï¼Œåªæƒ³åœ¨è¿™ä¸ªæ ‘æ´é‡Œå¾…ä¸€ä¼šå„¿ã€‚", date: "1å°æ—¶å‰" },
        { text: "æ„Ÿè§‰è‡ªå·±åƒä¸ªåºŸç‰©ï¼Œä»€ä¹ˆéƒ½åšä¸å¥½ã€‚ä½†å›ä¿¡è¯´æˆ‘ä¹Ÿæ˜¯å¥‡è¿¹ï¼Œè°¢è°¢ä½ éª—æˆ‘ï¼Œä½†æˆ‘ä¿¡äº†ã€‚", date: "3å°æ—¶å‰" },
        { text: "å³ä½¿æ˜¯å«æ³ªå¥”è·‘çš„äººï¼Œä¹Ÿå€¼å¾—æ‹¥æœ‰æŒå£°ã€‚", date: "æ˜¨å¤©" },
        { text: "ä»¥å‰æ€»æƒ³æ‹¯æ•‘ä¸–ç•Œï¼Œç°åœ¨åªæƒ³æ‹¯æ•‘é‚£ä¸ªä¸å¼€å¿ƒçš„è‡ªå·±ã€‚", date: "åˆšåˆš" },
        { text: "å¦‚æœä½ ä¹Ÿè§‰å¾—ç´¯ï¼Œé‚£å°±åœä¸‹æ¥å§ã€‚ä¼‘æ¯ä¸å¯è€»ã€‚", date: "15åˆ†é’Ÿå‰" },
        { text: "æ²¡æœ‰ä»€ä¹ˆè¿‡ä¸å»çš„åï¼Œåªæœ‰è¿‡ä¸å»çš„å¿ƒæƒ…ã€‚", date: "2å°æ—¶å‰" },
        { text: "ä»Šæ™šæœˆè‰²çœŸç¾ï¼Œå¸Œæœ›ä½ ä¹Ÿèƒ½çœ‹åˆ°ã€‚", date: "æ·±å¤œ" },
        { text: "è¿˜åœ¨åŠ ç­ï¼Œçœ‹ç€çª—å¤–çš„ä¸‡å®¶ç¯ç«ï¼Œçªç„¶æœ‰ç‚¹æƒ³å®¶ã€‚", date: "21:30" },
        { text: "å“ªæ€•åªæœ‰ä¸€ä¸ªäººæ‡‚ä½ ï¼Œä¹Ÿæ˜¯è«å¤§çš„å¹¸è¿ã€‚", date: "åˆšåˆš" },
        { text: "è¢«æ²»æ„ˆäº†ã€‚åŸæ¥åœ¨è¿™ä¸ªä¸–ç•Œä¸Šï¼Œæˆ‘å¹¶ä¸å­¤å•ã€‚", date: "5åˆ†é’Ÿå‰" },
        { text: "æŠŠä¸å¼€å¿ƒçš„äº‹å†™åœ¨çº¸ä¸Šï¼Œç„¶åçƒ§æ‰ï¼Œæ„Ÿè§‰å¥½å¤šäº†ã€‚", date: "æ˜¨å¤©" },
        { text: "å¸Œæœ›æ˜å¤©çš„å¤ªé˜³èƒ½æ™’å¹²æˆ‘çš„æ‚²ä¼¤ã€‚", date: "æ·±å¤œ" },
        { text: "æŠ±æŠ±è‡ªå·±ï¼Œè¿™ä¸€è·¯èµ°æ¥ï¼Œè¾›è‹¦äº†ã€‚", date: "åˆšåˆš" },
        { text: "è™½ç„¶å¾ˆéš¾ï¼Œä½†æˆ‘è¿˜åœ¨åšæŒã€‚æˆ‘ä»¬ä¸€èµ·åŠ æ²¹å¥½å—ï¼Ÿ", date: "1å°æ—¶å‰" },
        { text: "åŸæ¥æ”¾ä¸‹å¹¶æ²¡æœ‰é‚£ä¹ˆéš¾ï¼Œåªè¦ä½ è‚¯è½¬èº«ã€‚", date: "æ˜¨å¤©" },
        { text: "ä»Šå¤©æ²¡å‘ç”Ÿä»€ä¹ˆç‰¹åˆ«çš„äº‹ï¼Œä½†å¿ƒæƒ…å¾ˆå¹³é™ï¼Œè¿™å°±æ˜¯å¹¸ç¦å§ã€‚", date: "ä¸‹åˆ" },
        { text: "æƒ³å»æ—…è¡Œï¼Œæƒ³å»ä¸€ä¸ªæ²¡äººè®¤è¯†æˆ‘çš„åœ°æ–¹ï¼Œé‡æ–°å¼€å§‹ã€‚", date: "åˆšåˆš" },
        { text: "è°¢è°¢è¿™ä¸ªç½‘ç«™ï¼Œè®©æˆ‘åœ¨å´©æºƒçš„è¾¹ç¼˜è¢«æ‹‰äº†ä¸€æŠŠã€‚", date: "30åˆ†é’Ÿå‰" },
        { text: "ä¸è¦å®³æ€•é»‘æš—ï¼Œå› ä¸ºæ˜Ÿæ˜Ÿåªæœ‰åœ¨é»‘æš—ä¸­æ‰ä¼šé—ªè€€ã€‚", date: "æ·±å¤œ" },
        { text: "ä»Šå¤©è¢«è€æ¿éª‚äº†ï¼Œèº²åœ¨å•æ‰€å“­ã€‚å‡ºæ¥åè¡¥ä¸ªå¦†ï¼Œç»§ç»­æ¬ç –ã€‚", date: "ä¸‹åˆ" },
        { text: "ç”Ÿæ´»æ€»æœ‰è£‚ç¼ï¼Œé‚£æ˜¯å…‰ç…§è¿›æ¥çš„åœ°æ–¹ã€‚", date: "åˆšåˆš" },
        { text: "æ…¢æ…¢æ¥ï¼Œæ¯”è¾ƒå¿«ã€‚", date: "æ˜¨å¤©" },
        { text: "å…è®¸ä¸€åˆ‡å‘ç”Ÿï¼Œæ˜¯æˆ‘æœ€è¿‘å­¦åˆ°çš„æœ€æœ‰ç”¨çš„è¯ã€‚", date: "1å°æ—¶å‰" },
        { text: "ä¸ç®¡å‘ç”Ÿäº†ä»€ä¹ˆï¼Œè®°å¾—æŒ‰æ—¶åƒé¥­ã€‚", date: "ä¸­åˆ" },
        { text: "æ™šå®‰ï¼Œé™Œç”Ÿäººã€‚æ„¿ä½ ä»Šæ™šæ— æ¢¦ï¼Œåªæœ‰å®‰ç¡ã€‚", date: "å‡Œæ™¨1ç‚¹" },
        { text: "æˆ‘ç›¸ä¿¡ï¼Œä¸€åˆ‡éƒ½æ˜¯æœ€å¥½çš„å®‰æ’ã€‚", date: "åˆšåˆš" },
        { text: "å› ä¸ºæ·‹è¿‡é›¨ï¼Œæ‰€ä»¥æƒ³ä¸ºä½ æ’‘æŠŠä¼ã€‚", date: "2å°æ—¶å‰" },
        { text: "æ´»ç€æœ¬èº«ï¼Œå°±æ˜¯ä¸€ä»¶ä¼Ÿå¤§çš„äº‹ã€‚", date: "æ˜¨å¤©" }
    ];

    const _DB = {
        PHQ9: ["åšäº‹æä¸èµ·åŠ²ï¼Ÿ","å¿ƒæƒ…ä½è½ã€å¿§éƒæˆ–ç»æœ›ï¼Ÿ","å…¥ç¡å›°éš¾ã€æ˜“é†’æˆ–ç¡å¾—å¤ªå¤šï¼Ÿ","æ„Ÿåˆ°ç–²å€¦æˆ–æ²¡æœ‰æ´»åŠ›ï¼Ÿ","é£Ÿæ¬²ä¸æŒ¯æˆ–åƒå¾—å¤ªå¤šï¼Ÿ","è§‰å¾—è‡ªå·±å¾ˆç³Ÿæˆ–å¾ˆå¤±è´¥ï¼Ÿ","éš¾ä»¥é›†ä¸­æ³¨æ„åŠ›ï¼Ÿ","åŠ¨ä½œç¼“æ…¢æˆ–çƒ¦èºä¸å®‰ï¼Ÿ","æœ‰ä¸å¦‚æ­»æ‰çš„å¿µå¤´ï¼Ÿ"],
        GAD7: ["æ„Ÿåˆ°ç´§å¼ ã€ç„¦è™‘æˆ–æ€¥èºï¼Ÿ","æ— æ³•åœæ­¢æˆ–æ§åˆ¶æ‹…å¿ƒï¼Ÿ","å¯¹å„ç§äº‹æƒ…æ‹…å¿ƒè¿‡å¤šï¼Ÿ","å¾ˆéš¾æ”¾æ¾ä¸‹æ¥ï¼Ÿ","ç”±äºä¸å®‰è€Œæ— æ³•é™åï¼Ÿ","å˜å¾—å®¹æ˜“çƒ¦èºæˆ–æ˜“æ€’ï¼Ÿ","æ„Ÿåˆ°å¥½åƒæœ‰å¯æ€•çš„äº‹ä¼šå‘ç”Ÿï¼Ÿ"],
        PSS10: ["æ„Ÿåˆ°è‡ªå·±å¤„ç†ä¸åŠ›ï¼Ÿ","æ„Ÿåˆ°æ— æ³•æ§åˆ¶ç”Ÿæ´»ï¼Ÿ","æ„Ÿåˆ°ç´§å¼ æˆ–å‹åŠ›ï¼Ÿ","æ„Ÿåˆ°éš¾ä»¥å¯¹ä»˜å›°éš¾ï¼Ÿ","æ„Ÿåˆ°æ„¤æ€’æˆ–æ¼ç«ï¼Ÿ","è§‰å¾—è‡ªå·±æ— æ³•èƒœä»»å·¥ä½œï¼Ÿ","å¯¹æ„æ–™å¤–çš„äº‹æ„Ÿåˆ°çƒ¦æ¼ï¼Ÿ","æ„Ÿåˆ°æ— æ³•æˆ˜èƒœå›°éš¾ï¼Ÿ","æ— æ³•æ§åˆ¶é‡è¦çš„äº‹ï¼Ÿ","æ„Ÿåˆ°äº‹æƒ…å¦‚ä½ æ‰€æ„¿ï¼Ÿ"]
    };

    const _components = {
        salutations: ["äº²çˆ±çš„ä¼™ä¼´ï¼š", "è‡´è¿œæ–¹çš„æœ‹å‹ï¼š", "å—¨ï¼Œä½ å¥½å‘€ï¼š", "äº²çˆ±çš„æ—…äººï¼š", "ç»™æ­¤åˆ»çš„ä½ ï¼š", "æˆ‘äº²çˆ±çš„æœ‹å‹ï¼š"],
        openings: [
            "è§ä¿¡å¦‚é¢ã€‚è°¢è°¢ä½ æ„¿æ„æŠŠè¿™äº›æ²‰ç”¸ç”¸çš„å¿ƒäº‹æ‰˜ä»˜ç»™æˆ‘ã€‚è™½ç„¶æˆ‘ä»¬ç´ æœªè°‹é¢ï¼Œä½†æˆ‘èƒ½æ„Ÿè§‰åˆ°æ­¤åˆ»çš„ä½ ï¼Œæ­£èƒŒè´Ÿç€ä¸ä¸ºäººçŸ¥çš„é‡é‡ã€‚",
            "è¯»åˆ°ä½ çš„æ–‡å­—æ—¶ï¼Œæˆ‘ä»¿ä½›çœ‹åˆ°ä¸€ä¸ªåœ¨é›¨ä¸­ç‹¬è‡ªèµ¶è·¯çš„èº«å½±ã€‚è¿™ä¸–ç•Œæœ‰æ—¶å€™ç¡®å®å¾ˆåµï¼Œå¯¹å§ï¼Ÿèƒ½åœ¨è¿™é‡Œå¬ä½ è¯´è¯´è¯ï¼ŒçœŸå¥½ã€‚",
            "è¿™æšé‚®ç¥¨æˆ‘æ”¶åˆ°äº†ã€‚è°¢è°¢ä½ å¸¦æˆ‘å»çœ‹äº†çœ‹ä½ å†…å¿ƒçš„è§’è½ã€‚é‚£é‡Œè™½ç„¶ç°åœ¨æœ‰ç‚¹æš—ï¼Œä½†æˆ‘çœ‹åˆ°äº†ä¸€é¢—éå¸¸æ¸©æŸ”ã€ä¹Ÿéå¸¸æ•æ„Ÿçš„å¿ƒã€‚",
            "è¿™å°ä¿¡ç©¿è¶Šäº†æ—¶é—´å’Œæ•°æ®çš„æµ·æ´‹æ¥åˆ°ä½ é¢å‰ã€‚æˆ‘æ„Ÿå—åˆ°äº†ä½ æ–‡å­—é‡Œçš„é‡é‡ï¼Œä¹Ÿæ„Ÿå—åˆ°äº†ä½ æƒ³è¦å˜å¥½çš„æ¸´æœ›ã€‚",
            "æˆ‘æƒ³éš”ç€å±å¹•ï¼Œè½»è½»æ‹¥æŠ±ä¸€ä¸‹é‚£ä¸ªæˆ–è®¸æ­£æ„Ÿåˆ°æ— åŠ©çš„ä½ ã€‚åœ¨è¿™ä¸ªå¿«èŠ‚å¥çš„ä¸–ç•Œé‡Œï¼Œè°¢è°¢ä½ æ„¿æ„åœä¸‹æ¥ï¼Œå“ªæ€•åªæœ‰å‡ åˆ†é’Ÿã€‚",
            "æ”¶åˆ°ä½ çš„æ¥ä¿¡äº†ã€‚åœ¨è¿™ä¸ªå¯‚é™çš„æ—¶åˆ»ï¼Œè¯·å…è®¸æˆ‘ä½œä¸ºä¸€ä¸ªå€¾å¬è€…ï¼Œååœ¨ä½ çš„èº«æ—ï¼Œé™ªä½ åº¦è¿‡è¿™æ®µæ—¶å…‰ã€‚"
        ],
        empathy: [
            "æˆ‘çŸ¥é“ï¼Œä½ å·²ç»åŠªåŠ›äº†å¾ˆä¹…ï¼ŒåŠªåŠ›åœ¨äººç¾¤ä¸­æ‰®æ¼”ä¸€ä¸ªâ€œæƒ…ç»ªç¨³å®šâ€çš„æˆå¹´äººã€‚é‚£äº›æ²¡èƒ½è¯´å‡ºå£çš„å§”å±ˆï¼Œå°±åƒé‹å­é‡Œçš„æ²™ç ¾ï¼Œç£¨å¾—ä½ ç”Ÿç–¼ã€‚",
            "è¯·ä¸è¦å› ä¸ºè‡ªå·±çš„â€œè„†å¼±â€è€Œæ„Ÿåˆ°ç¾æ„§ã€‚çœŸæ­£çš„åšå¼ºä¸æ˜¯é“œå¢™é“å£ï¼Œè€Œæ˜¯æµç€æ³ªä¾ç„¶æ„¿æ„é¢å¯¹æ˜å¤©ã€‚ä½ çš„æ¯ä¸€æ¬¡çœ¼æ³ªï¼Œéƒ½æ˜¯åœ¨ä¸ºçµé­‚æ’æ¯’ã€‚",
            "ä½ æ€»æ˜¯ä¹ æƒ¯è‹›è´£è‡ªå·±ï¼Œè§‰å¾—ä¸å¤Ÿå¥½ï¼Œä¸å¤Ÿä¼˜ç§€ï¼Œä¸å¤Ÿè®¨äººå–œæ¬¢ã€‚ä½†æˆ‘æƒ³å‘Šè¯‰ä½ ä¸€ä¸ªç§˜å¯†ï¼šä½ ä»…ä»…æ˜¯å­˜åœ¨ç€ï¼Œå°±å·²ç»æ˜¯å®‡å®™ä¸­ç‹¬ä¸€æ— äºŒçš„å¥‡è¿¹äº†ã€‚",
            "ç”Ÿæ´»æœ‰æ—¶å€™çœŸçš„å¾ˆåƒä¸€åœºæ²¡æœ‰å½©æ’çš„æ¼”å‡ºï¼Œæˆ‘ä»¬éš¾å…ä¼šå¿˜è¯ï¼Œä¼šæ€¯åœºï¼Œè¿™å¤ªæ­£å¸¸äº†ã€‚è°è§„å®šäº†äººä¸€å®šè¦æ°¸è¿œæ­£ç¡®ã€æ°¸è¿œç§¯æå‘¢ï¼Ÿ",
            "æˆ‘ä»¬æ€»æ˜¯è¢«æ•™å¯¼è¦â€œå¿«ä¹â€ï¼Œå¥½åƒä¸å¿«ä¹å°±æ˜¯ä¸€ç§é”™è¯¯ã€‚ä½†ä½ çš„æ‚²ä¼¤ã€æ„¤æ€’ã€ç„¦è™‘ï¼Œéƒ½æ˜¯åˆæ³•çš„ï¼Œå®ƒä»¬æ˜¯ä½ èº«ä½“çš„ä¿¡ä½¿ï¼Œæƒ³å‘Šè¯‰ä½ æœ‰äº›åœ°æ–¹éœ€è¦è¢«å…³ç…§äº†ã€‚",
            "æˆ‘å¬åˆ°äº†ä½ å†…å¿ƒé‚£ä¸ªå¾®å°çš„å£°éŸ³ï¼Œå®ƒåœ¨è¯´â€œæˆ‘ç´¯äº†â€ã€‚è¿™æ²¡å…³ç³»ï¼ŒçœŸçš„æ²¡å…³ç³»ã€‚æ‰¿è®¤ç–²æƒ«ï¼Œæ˜¯çˆ±è‡ªå·±çš„ç¬¬ä¸€æ­¥ã€‚"
        ],
        metaphors: [
            "ä½ çš„â€œæ²¡åŠ›æ°”â€ï¼Œå…¶å®æ˜¯å†…å¿ƒçš„å°å­©åœ¨å–Šï¼šâ€œæˆ‘ç´¯äº†ï¼Œè¯·è®©æˆ‘ä¼‘æ¯ä¸€ä¸‹ã€‚â€ä¿é™©ä¸çƒ§æ–­ä¸æ˜¯ä¸ºäº†æƒ©ç½šï¼Œè€Œæ˜¯ä¸ºäº†ä¿æŠ¤ç”µè·¯ä¸è¢«ç„šæ¯ã€‚è¯·å…è®¸è‡ªå·±æ–­ç”µä¸€ä¼šå„¿ã€‚",
            "ä½ ç°åœ¨çš„ç—›è‹¦ï¼Œå°±åƒç”Ÿé•¿ç—›ä¸€æ ·ï¼Œè™½ç„¶éš¾å—ï¼Œä½†å®ƒæ„å‘³ç€æ—§çš„å£³æ­£åœ¨è£‚å¼€ï¼Œæ–°çš„ä½ æ­£åœ¨é…é…¿ã€‚æ‰€æœ‰çš„è£‚ç—•ï¼Œæœ€åéƒ½ä¼šå˜æˆå…‰ç…§è¿›æ¥çš„åœ°æ–¹ã€‚",
            "ä¸è¦æ€¥ç€èµ¶èµ°è¿™äº›æƒ…ç»ªã€‚è¯•ç€æ”¾ä¸‹é‡æ‹…ï¼Œå“ªæ€•åªæœ‰å‡ åˆ†é’Ÿã€‚æƒ³è±¡æŠŠèƒŒåŒ…æ”¾åœ¨è·¯è¾¹ï¼Œæ·±å¸ä¸€å£æ°”ã€‚ä¸–ç•Œä¾ç„¶åœ¨è½¬åŠ¨ï¼Œå¹¶æ²¡æœ‰å› ä¸ºä½ çš„æš‚åœè€Œå´©å¡Œã€‚",
            "å³ä½¿ç°åœ¨ä½ çœ‹ä¸åˆ°æ–¹å‘ï¼Œä¹Ÿæ²¡å…³ç³»ã€‚è¿·èŒ«çš„æ—¶å€™ï¼Œå°±åªçœ‹è„šä¸‹è¿™ä¸€æ­¥ã€‚é‚£äº›æ€ä¸æ­»ä½ çš„ï¼Œç»ˆå°†ä½¿ä½ æ›´å¼ºå¤§ã€‚é£æš´æ€»ä¼šè¿‡å»çš„ã€‚",
            "æ˜Ÿæ˜Ÿåœ¨ç™½å¤©ä¹Ÿæ˜¯ä¸å‘å…‰çš„ï¼Œä½†å®ƒä»¬ä»æœªæ¶ˆå¤±ã€‚è¯·ç›¸ä¿¡ä½ ä½“å†…æ½œè—çš„åŠ›é‡ï¼Œå®ƒæ­£åœ¨ç§¯è“„ï¼Œç­‰å¾…åˆé€‚çš„æ—¶æœºå†æ¬¡é—ªè€€ã€‚",
            "å¦‚æœä½ è§‰å¾—æ­¤åˆ»èº«å¤„é»‘æš—ï¼Œè¯·è®°å¾—ï¼Œç§å­ä¹Ÿæ˜¯åœ¨é»‘æš—ä¸­å‘èŠ½çš„ã€‚åœ°åº•ä¸‹çš„æ ¹ï¼Œæ­£åœ¨ä½ çœ‹ä¸è§çš„åœ°æ–¹æ‚„æ‚„æ±²å–é‡ç”Ÿçš„å…»åˆ†ã€‚"
        ],
        closings: [
            "å¦‚æœç°åœ¨æ˜¯å¯’å†¬ï¼Œé‚£å°±å®‰å®‰é™é™åœ°å†¬çœ ã€‚ä¸è¦è´£æ€ªè‡ªå·±æ²¡æœ‰å¼€èŠ±ï¼Œä¸è¦è´£æ€ªè‡ªå·±ä¸å¤ŸæŒºæ‹”ã€‚æ˜¥å¤©ä¸€å®šä¼šæ¥ï¼Œä½†åœ¨é‚£ä¹‹å‰ï¼Œè¯·ç…§é¡¾å¥½è‡ªå·±ã€‚",
            "è®°ä½ï¼Œæ²¡æœ‰ä»»ä½•ä¸€åœºé›¨ä¼šæ°¸è¿œä¸‹ä¸ªä¸åœã€‚äº‘å±‚ä¹‹ä¸Šï¼Œé˜³å…‰ä¸€ç›´éƒ½åœ¨ã€‚ç­‰è¿™é˜µé£è¿‡å»ï¼Œä½ ä¼šå‘ç°ç©ºæ°”å˜å¾—å‰æ‰€æœªæœ‰çš„é€æ˜ã€‚æˆ‘ä»¬æ…¢æ…¢æ¥ï¼Œä¸ç€æ€¥ã€‚",
            "å¦‚æœä»Šæ™šå¾ˆéš¾ç†¬ï¼Œè¯·è®°å¾—ï¼Œåœ¨ä¸–ç•Œçš„æŸä¸ªè§’è½ï¼Œæœ‰ä¸€ä¸ªå£°éŸ³æ­£åœ¨æ— æ¡ä»¶åœ°æ¥çº³ä½ çš„ä¸€åˆ‡ã€‚ä½ çš„æ‚²ä¼¤ã€ä½ çš„æ„¤æ€’ã€ä½ çš„ä¸å ªï¼Œåœ¨è¿™é‡Œéƒ½æ˜¯å®‰å…¨çš„ã€‚",
            "æ„¿ä»Šæ™šçš„æ¢¦é‡Œæ²¡æœ‰ç„¦è™‘ï¼Œåªæœ‰æ˜Ÿå…‰ã€‚å–ä¸€æ¯æ¸©çƒ­çš„æ°´ï¼Œç¡ä¸€ä¸ªé¥±è§‰ã€‚æ˜å¤©åˆæ˜¯æ–°çš„ä¸€å¤©ï¼Œå¤ªé˜³ç…§å¸¸å‡èµ·ã€‚",
            "å½“ä½ å¼€å§‹è‡ªæˆ‘å…³æ€€ï¼Œç–—æ„ˆå°±å·²ç»å‘ç”Ÿäº†ã€‚è¯·ç›¸ä¿¡ï¼Œç©ºæ°”ä¼šå˜é€æ˜ï¼Œä½ ä¹Ÿä¸€æ ·ã€‚ä½ å€¼å¾—è¢«çˆ±ï¼Œä»…ä»…å› ä¸ºä½ æ˜¯ä½ ã€‚",
            "è¯·å¤šç»™è‡ªå·±ä¸€ç‚¹è€å¿ƒï¼Œå°±åƒç­‰ä¸€æœµèŠ±å¼€ã€‚æˆ‘ä¼šåœ¨è¿™é‡Œï¼Œå®ˆç€ä½ çš„æ ‘æ´ï¼Œä¸€ç›´é™ªç€ä½ ã€‚ä½ å¹¶ä¸å­¤å•ã€‚"
        ],
        signatures: [
            "â€”â€” ä½ çš„ä¼™ä¼´ [ä½ å¥½å—]",
            "â€”â€” å®ˆå€™ä½ çš„ [ä½ å¥½å—]",
            "â€”â€” [ä½ å¥½å—] æ ‘æ´",
            "â€”â€” ä½ çš„å½±å­æœ‹å‹ [ä½ å¥½å—]",
            "â€”â€” åœ¨è¿™é‡Œçš„ [ä½ å¥½å—]",
            "â€”â€” æ°¸è¿œå€¾å¬çš„ [ä½ å¥½å—]"
        ]
    };

    function generateLetter() {
        const c = _components;
        const rand = (arr) => arr[Math.floor(Math.random() * arr.length)];
        return `${rand(c.salutations)}\n\n${rand(c.openings)}\n\n${rand(c.empathy)}\n\n${rand(c.metaphors)}\n\n${rand(c.closings)}\n\n${rand(c.signatures)}`;
    }

    let _type = '', _idx = 0, _scoreStack = [], isMusicPlaying = false;

    function toggleMusic() {
        const audio = document.getElementById('bgm');
        const btn = document.getElementById('m-btn');
        if(!isMusicPlaying) { 
            audio.play().then(() => { btn.innerText = 'ğŸµ æ—‹å¾‹å·²å¯'; btn.style.color = '#fff'; }).catch(e => { alert("ç‚¹å‡»æ’­æ”¾å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨ç‚¹å‡»"); });
        } else { 
            audio.pause(); btn.innerText = 'ğŸµ å¼€å¯é™è°§æ—‹å¾‹'; btn.style.color = 'var(--accent)';
        }
        isMusicPlaying = !isMusicPlaying;
    }

    function navPage(id) {
        ['p-home', 'p-test', 'p-report', 'p-sd', 'p-echo', 'p-wall'].forEach(p => document.getElementById(p).style.display = 'none');
        document.getElementById(id).style.display = 'block';
        window.scrollTo(0, 0); 
    }

    function resetToHome() { _scoreStack = []; _idx = 0; document.getElementById('sd-input').value = ''; navPage('p-home'); }
    
    // --- â˜… No.30 æ ¸å¿ƒä¿®å¤ï¼šå³æ—¶å­˜å‚¨ + è§†è§‰åé¦ˆ â˜… ---
    function startProcess() {
        const inputDom = document.getElementById('sd-input');
        const input = inputDom.value;
        if(!input) return alert("å†™ä¸€ä¸ªå­—ä¹Ÿå¥½å‘€...");
        
        // 1. ç«‹å³å­˜å…¥æ–°æ•°æ®åº“ Key
        try {
            let echos = JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");
            echos.unshift({ 
                text: input, 
                date: new Date().toLocaleDateString() 
            });
            localStorage.setItem(STORAGE_KEY, JSON.stringify(echos));
            
            // 2. è§†è§‰åé¦ˆï¼šæŒ‰é’®å˜è‰²
            const btn = document.getElementById('btn-submit-hole');
            const originalText = btn.innerText;
            btn.innerText = "âœ… å·²å°å­˜";
            btn.style.background = "var(--safe)";
            
            // 3. å»¶è¿Ÿåè¿›å…¥åŠ¨ç”»
            setTimeout(() => {
                const overlay = document.getElementById('process-overlay');
                const txt = document.getElementById('process-msg');
                overlay.style.display = 'flex';
                txt.innerText = "æ­£åœ¨å°å¿ƒç¿¼ç¿¼åœ°æŠ˜å ä¿¡çº¸...";
                
                // æ¢å¤æŒ‰é’®çŠ¶æ€ï¼ˆä¸ºäº†ä¸‹æ¬¡ï¼‰
                btn.innerText = originalText;
                btn.style.background = ""; // æ¢å¤é»˜è®¤æ¸å˜
                
                setTimeout(() => { txt.innerText = "æ­£åœ¨æ»´ä¸Šç«æ¼†å°å£..."; }, 1500);
                setTimeout(() => { overlay.style.display = 'none'; openPay(); }, 3000);
            }, 500);
            
        } catch(e) {
            console.error("Save failed", e);
            alert("å­˜å‚¨å¤±è´¥ï¼Œè¯·å…³é—­æ— ç—•æµè§ˆé‡è¯•");
        }
    }
    
    function openPay() { document.getElementById('pay-overlay').style.display = 'flex'; }
    
    function finishPay() {
        document.getElementById('pay-overlay').style.display = 'none';
        navPage('p-echo');
        const letter = generateLetter();
        typeWrite(letter);
    }
    
    function copyLink() {
        const url = "https://ai0-1.github.io/howareu/";
        navigator.clipboard.writeText(url).then(() => { alert("é“¾æ¥å·²å¤åˆ¶ï¼\nå¿«å»å¾®ä¿¡ç²˜è´´åˆ†äº«ç»™éœ€è¦çš„æœ‹å‹å§ã€‚"); }).catch(err => { alert("å¤åˆ¶å¤±è´¥ï¼Œè¯·é•¿æŒ‰æµè§ˆå™¨åœ°å€æ å¤åˆ¶ã€‚"); });
    }
    
    function openWall() {
        navPage('p-wall');
        const container = document.getElementById('wall-container');
        
        // 1. è¯»å–è‡ªå·±çš„å¿ƒå£°
        let myEchos = [];
        try {
            myEchos = JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");
        } catch(e) {}
        myEchos = myEchos.map(e => ({ ...e, isMine: true }));

        // 2. éšæœºè·¯äºº
        let randomOthers = [..._baseWallDB].sort(() => 0.5 - Math.random()).slice(0, 15);
        
        // 3. åˆå¹¶
        let displayList = [...myEchos, ...randomOthers];

        let html = '';
        displayList.forEach(item => {
            if(item.isMine) {
                html += `<div class="wall-card-mine">${item.text}<div class="wall-meta" style="color:var(--mine)">${item.date} | ä½ çš„å¿ƒå£°</div></div>`;
            } else {
                html += `<div class="wall-card">${item.text}<div class="wall-meta">${item.date}</div></div>`;
            }
        });
        container.innerHTML = html;
    }

    function showPoster() {
        const total = _scoreStack.reduce((a, b) => a + b, 0);
        document.getElementById('poster-date').innerText = new Date().toLocaleDateString();
        document.getElementById('poster-score-val').innerText = total;
        document.getElementById('poster-keyword-val').innerText = getPosterKeyword(total, _type);
        document.getElementById('poster-desc-val').innerText = getPosterDesc(total, _type);
        document.getElementById('poster-overlay').style.display = 'flex';
        setTimeout(() => { drawRadar('poster-radar', 200, 160, true); }, 100);
    }
    function getPosterKeyword(s, t) {
        if(s <= 5) return "å¹³é™çš„æ¹–é¢";
        if(s <= 10) return "å¾®é£ä¸­çš„èŠ¦è‹‡";
        if(s <= 15) return "æ²‰é»˜çš„æˆ˜å£«";
        return "ç­‰å¾…é»æ˜çš„å®ˆå¤œäºº";
    }
    function getPosterDesc(s, t) {
        if(s <= 9) return "ä½ çš„å†…å¿ƒæœ‰ä¸€è‚¡æ¸©æŸ”çš„åŠ›é‡ï¼Œæ­£åœ¨æ…¢æ…¢æ²»æ„ˆè‡ªå·±ã€‚ä¿æŒè¿™ä»½èŠ‚å¥ã€‚";
        return "ç°åœ¨çš„ä½ å¯èƒ½è§‰å¾—å¾ˆç´¯ï¼Œè¿™æ²¡å…³ç³»ã€‚å…è®¸è‡ªå·±ç ´ç¢ï¼Œæ˜¯é‡å»ºçš„å¼€å§‹ã€‚";
    }
    function runStart(type) { _type = type; _idx = 0; _scoreStack = []; navPage('p-test'); updateQ(); }
    function updateQ() { document.getElementById('q-txt').innerText = _DB[_type][_idx]; }
    function runStep(s) {
        if (_type === 'PHQ9' && _idx === 8 && s > 0) { document.getElementById('crisis-overlay').style.display = 'flex'; }
        _scoreStack.push(s); _idx++; if (_idx < _DB[_type].length) updateQ(); else showReport();
    }
    function closeCrisis() { document.getElementById('crisis-overlay').style.display = 'none'; }
    function runBack() { if (_idx > 0) { _idx--; _scoreStack.pop(); updateQ(); } }
    function showReport() {
        const total = _scoreStack.reduce((a, b) => a + b, 0);
        document.getElementById('dom-score').innerText = total;
        document.getElementById('dom-level').innerText = getLevel(total, _type);
        document.getElementById('dom-diag').innerText = getDesc(total, _type);
        navPage('p-report');
        setTimeout(() => drawRadar('dom-radar', 300, 240, false), 200);
    }
    function getLevel(s, t) {
        if(t==='PHQ9') return s<=4?"çŠ¶æ€è‰¯å¥½":s<=9?"è½»åº¦æŠ‘éƒ":s<=14?"ä¸­åº¦æŠ‘éƒ":s<=19?"ä¸­é‡åº¦çŠ¶æ€":"é‡åº¦çŠ¶æ€";
        if(t==='GAD7') return s<=4?"å¿ƒå¢ƒç¥¥å’Œ":s<=9?"è½»åº¦ç„¦è™‘":"ä¸­é‡åº¦ç„¦è™‘";
        return "å‹åŠ›é€‚ä¸­";
    }
    function getDesc(s, t) {
        if(t==='PHQ9') return s<=9 ? "å¿ƒçµçš„å°æ„Ÿå†’ï¼Œé€‚å½“ä¼‘æ¯ä¼šå¥½è½¬ã€‚" : "æ­¤åˆ»çš„é»‘æš—å¾ˆé‡ï¼Œä½†è¯·è®°å¾—ï¼Œä½ ä¾ç„¶é‡è¦ã€‚ä¸è¦ç‹¬è‡ªç¡¬æ‰›ã€‚";
        if(t==='GAD7') return s<=9 ? "æœ‰äº›ç´§ç»·ï¼Œè¯•ç€æ·±å‘¼å¸ï¼Œæ”¾æ…¢è„šæ­¥ã€‚" : "è„‘æµ·é‡Œçš„å™ªéŸ³è¿‡è½½äº†ï¼Œç»™è‡ªå·±ä¸€æ®µçœŸç©ºæ—¶é—´ã€‚";
        return "å¿ƒç†éŸ§æ€§è‰¯å¥½ï¼Œå‹åŠ›ä¹Ÿæ˜¯åŠ¨åŠ›çš„å½±å­ã€‚";
    }
    function typeWrite(text) {
        let i = 0; const dom = document.getElementById('echo-content'); dom.innerText = '';
        const timer = setInterval(() => { 
            if (i < text.length) {
                dom.innerText += text.charAt(i++); 
                window.scrollTo(0, document.body.scrollHeight);
            } else { clearInterval(timer); }
        }, 30);
    }
    function drawRadar(canvasId, w, h, isGold) {
        const canvas = document.getElementById(canvasId); if(!canvas) return;
        const ctx = canvas.getContext('2d');
        const dpr = window.devicePixelRatio || 1;
        canvas.width = w * dpr; canvas.height = h * dpr;
        ctx.scale(dpr, dpr);
        const cx = w/2, cy = h/2, r = h/3.5;
        const lineColor = isGold ? "rgba(212, 175, 55, 0.3)" : "rgba(255,255,255,0.1)";
        const fillColor = isGold ? "rgba(212, 175, 55, 0.4)" : "rgba(240, 147, 43, 0.5)";
        const strokeColor = isGold ? "#d4af37" : "rgba(240, 147, 43, 1)";
        const textColor = isGold ? "#d4af37" : "#fff";

        ctx.strokeStyle = lineColor; ctx.lineWidth = 1;
        for (let j = 1; j <= 3; j++) {
            ctx.beginPath();
            for (let i = 0; i < 4; i++) {
                let ang = i * Math.PI/2 - Math.PI/2;
                let x = cx + (r * j / 3) * Math.cos(ang);
                let y = cy + (r * j / 3) * Math.sin(ang);
                i === 0 ? ctx.moveTo(x, y) : ctx.lineTo(x, y);
            }
            ctx.closePath(); ctx.stroke();
        }
        ctx.beginPath();
        for (let i = 0; i < 4; i++) {
             let ang = i * Math.PI/2 - Math.PI/2;
             ctx.moveTo(cx, cy); ctx.lineTo(cx + r * Math.cos(ang), cy + r * Math.sin(ang));
        }
        ctx.stroke();
        ctx.fillStyle = fillColor; ctx.strokeStyle = strokeColor;
        ctx.beginPath();
        for (let i = 0; i < 4; i++) {
            let ang = i * Math.PI/2 - Math.PI/2;
            let val = [0.8, 0.65, 0.75, 0.9][i] * r;
            let x = cx + val * Math.cos(ang);
            let y = cy + val * Math.sin(ang);
            i === 0 ? ctx.moveTo(x, y) : ctx.lineTo(x, y);
        }
        ctx.closePath(); ctx.fill(); ctx.stroke();
        ctx.fillStyle = textColor; ctx.font = "12px sans-serif"; ctx.textAlign = "center";
        ["å¿ƒå¢ƒ","ç”Ÿç†","è®¤çŸ¥","è‡ªæˆ‘"].forEach((t, i) => {
            let ang = i * Math.PI/2 - Math.PI/2;
            ctx.fillText(t, cx + (r + 20) * Math.cos(ang), cy + (r + 20) * Math.sin(ang) + 4);
        });
    }
</script>
</body>
</html>
